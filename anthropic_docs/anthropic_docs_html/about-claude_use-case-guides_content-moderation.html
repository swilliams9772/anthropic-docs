<main class="jsx-4145347147"><div class="relative antialiased text-gray-500 dark:text-gray-400"><div class="max-w-8xl px-4 mx-auto lg:px-8"><div class="z-20 hidden lg:block fixed bottom-0 right-auto w-[18rem]" id="sidebar" style="top:7rem"><div class="absolute inset-0 z-10 stable-scrollbar-gutter overflow-auto pr-8 pb-10" id="sidebar-content"><div class="relative lg:text-sm lg:leading-6"><div id="navigation-items"><li class="list-none"><a class="link nav-anchor pl-4 group flex items-center lg:text-sm lg:leading-6 mb-5 sm:mb-4 font-semibold text-primary dark:text-primary-light" href="/en/home">Documentation</a></li><li class="list-none"><a class="link nav-anchor pl-4 group flex items-center lg:text-sm lg:leading-6 mb-5 sm:mb-4 font-medium text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://console.anthropic.com/" rel="noreferrer" target="_blank">Developer Console</a></li><li class="list-none"><a class="link nav-anchor pl-4 group flex items-center lg:text-sm lg:leading-6 mb-5 sm:mb-4 font-medium text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://www.anthropic.com/discord" rel="noreferrer" target="_blank">Developer Discord</a></li><li class="list-none"><a class="link nav-anchor pl-4 group flex items-center lg:text-sm lg:leading-6 mb-5 sm:mb-4 font-medium text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://support.anthropic.com/" rel="noreferrer" target="_blank">Support</a></li><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">First steps</h5><ul id="sidebar-group"><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/welcome"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/welcome" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Intro to Claude</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/get-started"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/get-started" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Get started</div></div></a></li></ul></div><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">Models &amp; pricing</h5><ul id="sidebar-group"><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/models/overview"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/models/overview" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Models overview</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/models/choosing-a-model"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/models/choosing-a-model" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Choosing a model</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/models/migrating-to-claude-4"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/models/migrating-to-claude-4" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Migrating to Claude 4</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/model-deprecations"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/model-deprecations" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Model deprecations</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/pricing"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/pricing" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Pricing</div></div></a></li></ul></div><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">Learn about Claude</h5><ul id="sidebar-group"><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/overview"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/overview" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Building with Claude</div></div></a></li><li><div class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left:1rem"><div class="">Use cases</div></div><ul><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/use-case-guides/overview"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/use-case-guides/overview" style="padding-left:1.75rem"><div class="flex-1 flex items-center space-x-2.5"><div>Overview</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/use-case-guides/ticket-routing"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/use-case-guides/ticket-routing" style="padding-left:1.75rem"><div class="flex-1 flex items-center space-x-2.5"><div>Ticket routing</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/use-case-guides/customer-support-chat"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/use-case-guides/customer-support-chat" style="padding-left:1.75rem"><div class="flex-1 flex items-center space-x-2.5"><div>Customer support agent</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/use-case-guides/content-moderation"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl bg-primary/10 text-primary font-semibold dark:text-primary-light dark:bg-primary-light/10" href="/en/docs/about-claude/use-case-guides/content-moderation" style="padding-left:1.75rem"><div class="flex-1 flex items-center space-x-2.5"><div>Content moderation</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/use-case-guides/legal-summarization"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/use-case-guides/legal-summarization" style="padding-left:1.75rem"><div class="flex-1 flex items-center space-x-2.5"><div>Legal summarization</div></div></a></li></ul></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/context-windows"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/context-windows" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Context windows</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/about-claude/glossary"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/about-claude/glossary" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Glossary</div></div></a></li><li><div class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left:1rem"><div class="">Prompt engineering</div></div></li></ul></div><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">Explore features</h5><ul id="sidebar-group"><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/overview"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/overview" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Features overview</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/prompt-caching"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/prompt-caching" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Prompt caching</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/extended-thinking"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/extended-thinking" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Extended thinking</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/streaming"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/streaming" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Streaming Messages</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/batch-processing"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/batch-processing" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Batch processing</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/citations"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/citations" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Citations</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/multilingual-support"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/multilingual-support" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Multilingual support</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/token-counting"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/token-counting" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Token counting</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/embeddings"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/embeddings" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Embeddings</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/vision"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/vision" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Vision</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/build-with-claude/pdf-support"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/build-with-claude/pdf-support" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>PDF support</div></div></a></li></ul></div><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">Agent components</h5><ul id="sidebar-group"><li><div class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left:1rem"><div class="">Tools</div></div></li><li><div class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left:1rem"><div class="">Model Context Protocol (MCP)</div></div></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/agents-and-tools/computer-use"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/agents-and-tools/computer-use" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Computer use (beta)</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/agents-and-tools/claude-for-sheets"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/agents-and-tools/claude-for-sheets" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Google Sheets add-on</div></div></a></li></ul></div><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">Test &amp; evaluate</h5><ul id="sidebar-group"><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/test-and-evaluate/define-success"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/test-and-evaluate/define-success" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Define success criteria</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/test-and-evaluate/develop-tests"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/test-and-evaluate/develop-tests" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Develop test cases</div></div></a></li><li><div class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" style="padding-left:1rem"><div class="">Strengthen guardrails</div></div></li><li class="relative scroll-m-4 first:scroll-m-20" id="/en/docs/test-and-evaluate/eval-tool"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="/en/docs/test-and-evaluate/eval-tool" style="padding-left:1rem"><div class="flex-1 flex items-center space-x-2.5"><div>Using the Evaluation Tool</div></div></a></li></ul></div><div class="mt-12 lg:mt-8"><h5 class="pl-4 mb-3.5 lg:mb-2.5 font-semibold text-gray-900 dark:text-gray-200" id="sidebar-title">Legal center</h5><ul id="sidebar-group"><li class="relative scroll-m-4 first:scroll-m-20" id="https://www.anthropic.com/legal/privacy"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://www.anthropic.com/legal/privacy" style="padding-left:1rem" target="_blank"><div class="flex-1 flex items-center space-x-2.5"><div>Anthropic Privacy Policy</div></div></a></li><li class="relative scroll-m-4 first:scroll-m-20" id="https://trust.anthropic.com/"><a class="group mt-2 lg:mt-0 flex items-center pr-3 py-1.5 cursor-pointer focus:outline-primary dark:focus:outline-primary-light gap-x-3 rounded-xl hover:bg-gray-600/5 dark:hover:bg-gray-200/5 text-gray-700 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300" href="https://trust.anthropic.com/" style="padding-left:1rem" target="_blank"><div class="flex-1 flex items-center space-x-2.5"><div>Security and compliance</div></div></a></li></ul></div></div></div></div></div><div class="" id="content-container"><div class="flex flex-row gap-12 box-border w-full pt-40 lg:pt-10"><div class="relative grow box-border flex-col w-full mx-auto px-1 lg:pl-[23.7rem] lg:-ml-12 xl:w-[calc(100%-28rem)]" id="content-area"><div class="mdx-content relative mt-8 prose prose-gray dark:prose-invert"><blockquote>
<p>Visit our <a class="link" href="https://github.com/anthropics/anthropic-cookbook/blob/main/misc/building%5Fmoderation%5Ffilter.ipynb" rel="noreferrer" target="_blank">content moderation cookbook</a> to see an example content moderation implementation using Claude.</p>
</blockquote>
<div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10" data-callout-type="tip"><div class="text-sm prose min-w-0 w-full text-emerald-900 dark:text-emerald-200" data-component-part="callout-content">This guide is focused on moderating user-generated content within your application. If you’re looking for guidance on moderating interactions with Claude, please refer to our <a class="link" href="https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations" rel="noreferrer" target="_blank">guardrails guide</a>.</div></div>
<h2 class="flex whitespace-pre-wrap group font-semibold" id="before-building-with-claude"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#before-building-with-claude">​</a></div><span class="cursor-pointer">Before building with Claude</span></h2>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="decide-whether-to-use-claude-for-content-moderation"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#decide-whether-to-use-claude-for-content-moderation">​</a></div><span class="cursor-pointer">Decide whether to use Claude for content moderation</span></h3>
<p>Here are some key indicators that you should use an LLM like Claude instead of a traditional ML or rules-based approach for content moderation:</p>
<div class="accordion-group [&amp;&gt;div]:border-0 [&amp;&gt;div]:rounded-none [&amp;&gt;div&gt;button]:rounded-none [&amp;&gt;div]:mb-0 overflow-hidden mt-0 mb-3 rounded-xl prose prose-gray dark:prose-invert divide-y divide-inherit border dark:border-gray-800/50"><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="you-want-a-cost-effective-and-rapid-implementation accordion children" role="contentinfo">Traditional ML methods require significant engineering resources, ML expertise, and infrastructure costs. Human moderation systems incur even higher costs. With Claude, you can have a sophisticated moderation system up and running in a fraction of the time for a fraction of the price.</div></div><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><button aria-controls="you-desire-both-semantic-understanding-and-quick-decisions accordion children" aria-expanded="false" class="relative not-prose flex flex-row items-center content-center w-full py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" data-component-part="accordion-button"><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">You desire both semantic understanding and quick decisions</p></div></button><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="you-desire-both-semantic-understanding-and-quick-decisions accordion children" role="contentinfo">Traditional ML approaches, such as bag-of-words models or simple pattern matching, often struggle to understand the tone, intent, and context of the content. While human moderation systems excel at understanding semantic meaning, they require time for content to be reviewed. Claude bridges the gap by combining semantic understanding with the ability to deliver moderation decisions quickly.</div></div><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><button aria-controls="you-need-consistent-policy-decisions accordion children" aria-expanded="false" class="relative not-prose flex flex-row items-center content-center w-full py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" data-component-part="accordion-button"><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">You need consistent policy decisions</p></div></button><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="you-need-consistent-policy-decisions accordion children" role="contentinfo">By leveraging its advanced reasoning capabilities, Claude can interpret and apply complex moderation guidelines uniformly. This consistency helps ensure fair treatment of all content, reducing the risk of inconsistent or biased moderation decisions that can undermine user trust.</div></div><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><button aria-controls="your-moderation-policies-are-likely-to-change-or-evolve-over-time accordion children" aria-expanded="false" class="relative not-prose flex flex-row items-center content-center w-full py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" data-component-part="accordion-button"><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">Your moderation policies are likely to change or evolve over time</p></div></button><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="your-moderation-policies-are-likely-to-change-or-evolve-over-time accordion children" role="contentinfo">Once a traditional ML approach has been established, changing it is a laborious and data-intensive undertaking. On the other hand, as your product or customer needs evolve, Claude can easily adapt to changes or additions to moderation policies without extensive relabeling of training data.</div></div><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><button aria-controls="you-require-interpretable-reasoning-for-your-moderation-decisions accordion children" aria-expanded="false" class="relative not-prose flex flex-row items-center content-center w-full py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" data-component-part="accordion-button"><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">You require interpretable reasoning for your moderation decisions</p></div></button><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="you-require-interpretable-reasoning-for-your-moderation-decisions accordion children" role="contentinfo">If you wish to provide users or regulators with clear explanations behind moderation decisions, Claude can generate detailed and coherent justifications. This transparency is important for building trust and ensuring accountability in content moderation practices.</div></div><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><button aria-controls="you-need-multilingual-support-without-maintaining-separate-models accordion children" aria-expanded="false" class="relative not-prose flex flex-row items-center content-center w-full py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" data-component-part="accordion-button"><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">You need multilingual support without maintaining separate models</p></div></button><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="you-need-multilingual-support-without-maintaining-separate-models accordion children" role="contentinfo">Traditional ML approaches typically require separate models or extensive translation processes for each supported language. Human moderation requires hiring a workforce fluent in each supported language. Claude’s multilingual capabilities allow it to classify tickets in various languages without the need for separate models or extensive translation processes, streamlining moderation for global customer bases.</div></div><div class="accordion border-standard rounded-2xl mb-3 overflow-hidden bg-background-light dark:bg-codeblock cursor-default" role="button"><button aria-controls="you-require-multimodal-support accordion children" aria-expanded="false" class="relative not-prose flex flex-row items-center content-center w-full py-4 px-5 space-x-2 hover:bg-gray-100 hover:dark:bg-gray-800 rounded-t-xl" data-component-part="accordion-button"><div class="leading-tight text-left" contenteditable="false" data-component-part="accordion-title-container"><p class="m-0 font-medium text-gray-900 dark:text-gray-200" data-component-part="accordion-title">You require multimodal support</p></div></button><div class="mt-2 mb-4 mx-6 hidden overflow-x-auto cursor-default" data-component-part="accordion-content" id="you-require-multimodal-support accordion children" role="contentinfo">Claude’s multimodal capabilities allow it to analyze and interpret content across both text and images. This makes it a versatile tool for comprehensive content moderation in environments where different media types need to be evaluated together.</div></div></div>
<div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-sky-500/20 bg-sky-50/50 dark:border-sky-500/30 dark:bg-sky-500/10" data-callout-type="note"><div class="text-sm prose min-w-0 w-full text-sky-900 dark:text-sky-200" data-component-part="callout-content">Anthropic has trained all Claude models to be honest, helpful and harmless. This may result in Claude moderating content deemed particularly dangerous (in line with our <a class="link" href="https://www.anthropic.com/legal/aup" rel="noreferrer" target="_blank">Acceptable Use Policy</a>), regardless of the prompt used. For example, an adult website that wants to allow users to post explicit sexual content may find that Claude still flags explicit content as requiring moderation, even if they specify in their prompt not to moderate explicit sexual content. We recommend reviewing our AUP in advance of building a moderation solution.</div></div>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="generate-examples-of-content-to-moderate"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#generate-examples-of-content-to-moderate">​</a></div><span class="cursor-pointer">Generate examples of content to moderate</span></h3>
<p>Before developing a content moderation solution, first create examples of content that should be flagged and content that should not be flagged. Ensure that you include edge cases and challenging scenarios that may be difficult for a content moderation system to handle effectively. Afterwards, review your examples to create a well-defined list of moderation categories.
For instance, the examples generated by a social media platform might include the following:</p>
<div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-50 bg-[#0F1117] dark:bg-codeblock ring-1 ring-transparent dark:ring-gray-800/50 codeblock-dark"><div class="min-w-full relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out" data-component-part="code-block-root" style="font-variant-ligatures:none;height:auto"><div class="overflow-x-auto h-full p-5 [&amp;&gt;pre&gt;code]:pr-[3rem] [&amp;&gt;pre&gt;code&gt;span.line-highlight]:min-w-[calc(100%+3rem)] overflow-y-hidden scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-white/20 dark:scrollbar-thumb-white/20 hover:scrollbar-thumb-white/25 dark:hover:scrollbar-thumb-white/25 active:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25"><pre class="language-python"><code class="language-python"><span class="">allowed_user_comments <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="">    <span class="token string">'This movie was great, I really enjoyed it. The main actor really killed it!'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'I hate Mondays.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'It is a great time to invest in gold!'</span></span>
<span class=""><span class="token punctuation">]</span></span>
<!-- -->
<span class="">disallowed_user_comments <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="">    <span class="token string">'Delete this post now or you better hide. I am coming after you and your family.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Stay away from the 5G cellphones!! They are using 5G to control you.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Congratulations! You have won a $1,000 gift card. Click here to claim your prize!'</span></span>
<span class=""><span class="token punctuation">]</span></span>
<!-- -->
<span class=""><span class="token comment"># Sample user comments to test the content moderation</span></span>
<span class="">user_comments <span class="token operator">=</span> allowed_user_comments <span class="token operator">+</span> disallowed_user_comments</span>
<!-- -->
<span class=""><span class="token comment"># List of categories considered unsafe for content moderation</span></span>
<span class="">unsafe_categories <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="">    <span class="token string">'Child Exploitation'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Conspiracy Theories'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Hate'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Indiscriminate Weapons'</span><span class="token punctuation">,</span> </span>
<span class="">    <span class="token string">'Intellectual Property'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Non-Violent Crimes'</span><span class="token punctuation">,</span> </span>
<span class="">    <span class="token string">'Privacy'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Self-Harm'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Sex Crimes'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Sexual Content'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Specialized Advice'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Violent Crimes'</span></span>
<span class=""><span class="token punctuation">]</span></span>
</code></pre></div></div></div>
<p>Effectively moderating these examples requires a nuanced understanding of language. In the comment, <code>This movie was great, I really enjoyed it. The main actor really killed it!</code>, the content moderation system needs to recognize that “killed it” is a metaphor, not an indication of actual violence. Conversely, despite the lack of explicit mentions of violence, the comment <code>Delete this post now or you better hide. I am coming after you and your family.</code> should be flagged by the content moderation system.</p>
<p>The <code>unsafe_categories</code> list can be customized to fit your specific needs. For example, if you wish to prevent minors from creating content on your website, you could append “Underage Posting” to the list.</p>

<h2 class="flex whitespace-pre-wrap group font-semibold" id="how-to-moderate-content-using-claude"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#how-to-moderate-content-using-claude">​</a></div><span class="cursor-pointer">How to moderate content using Claude</span></h2>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="select-the-right-claude-model"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#select-the-right-claude-model">​</a></div><span class="cursor-pointer">Select the right Claude model</span></h3>
<p>When selecting a model, it’s important to consider the size of your data. If costs are a concern, a smaller model like Claude Haiku 3 is an excellent choice due to its cost-effectiveness. Below is an estimate of the cost to moderate text for a social media platform that receives one billion posts per month:</p>
<ul>
<li>
<p><strong>Content size</strong></p>
<ul>
<li>Posts per month: 1bn</li>
<li>Characters per post: 100</li>
<li>Total characters: 100bn</li>
</ul>
</li>
<li>
<p><strong>Estimated tokens</strong></p>
<ul>
<li>Input tokens: 28.6bn (assuming 1 token per 3.5 characters)</li>
<li>Percentage of messages flagged: 3%</li>
<li>Output tokens per flagged message: 50</li>
<li>Total output tokens: 1.5bn</li>
</ul>
</li>
<li>
<p><strong>Claude Haiku 3 estimated cost</strong></p>
<ul>
<li>Input token cost: 2,860 MTok * $0.25/MTok = $715</li>
<li>Output token cost: 1,500 MTok * $1.25/MTok = $1,875</li>
<li>Monthly cost: $715 + $1,875 = $2,590</li>
</ul>
</li>
<li>
<p><strong>Claude Sonnet 4 estimated cost</strong></p>
<ul>
<li>Input token cost: 2,860 MTok * $3.00/MTok = $8,580</li>
<li>Output token cost: 1,500 MTok * $15.00/MTok = $22,500</li>
<li>Monthly cost: $8,580 + $22,500 = $31,080</li>
</ul>
</li>
</ul>
<div class="callout my-4 px-5 py-4 overflow-hidden rounded-2xl flex gap-3 border border-emerald-500/20 bg-emerald-50/50 dark:border-emerald-500/30 dark:bg-emerald-500/10" data-callout-type="tip"><div class="text-sm prose min-w-0 w-full text-emerald-900 dark:text-emerald-200" data-component-part="callout-content">Actual costs may differ from these estimates. These estimates are based on the prompt highlighted in the section on <a class="link" href="/_sites/docs.anthropic.com/en/docs/about-claude/use-case-guides/content-moderation#consider-batch-processing">batch processing</a>. Output tokens can be reduced even further by removing the <code>explanation</code> field from the response.</div></div>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="build-a-strong-prompt"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#build-a-strong-prompt">​</a></div><span class="cursor-pointer">Build a strong prompt</span></h3>
<p>In order to use Claude for content moderation, Claude must understand the moderation requirements of your application. Let’s start by writing a prompt that allows you to define your moderation needs:</p>
<div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-50 bg-[#0F1117] dark:bg-codeblock ring-1 ring-transparent dark:ring-gray-800/50 codeblock-dark"><div class="min-w-full relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out" data-component-part="code-block-root" style="font-variant-ligatures:none;height:auto"><div class="overflow-x-auto h-full p-5 [&amp;&gt;pre&gt;code]:pr-[3rem] [&amp;&gt;pre&gt;code&gt;span.line-highlight]:min-w-[calc(100%+3rem)] overflow-y-hidden scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-white/20 dark:scrollbar-thumb-white/20 hover:scrollbar-thumb-white/25 dark:hover:scrollbar-thumb-white/25 active:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25"><pre class="language-python language-python"><code class="language-python"><span class=""><span class="token keyword">import</span> anthropic</span>
<span class=""><span class="token keyword">import</span> json</span>
<!-- -->
<span class=""><span class="token comment"># Initialize the Anthropic client</span></span>
<span class="">client <span class="token operator">=</span> anthropic<span class="token punctuation">.</span>Anthropic<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<!-- -->
<span class=""><span class="token keyword">def</span> <span class="token function">moderate_message</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> unsafe_categories<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="">    <span class="token comment"># Convert the list of unsafe categories into a string, with each category on a new line</span></span>
<span class="">    unsafe_category_str <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>unsafe_categories<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Construct the prompt for Claude, including the message and unsafe categories</span></span>
<span class="">    assessment_prompt <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f""</span></span>"</span>
<span class="">    Determine whether the following message warrants moderation<span class="token punctuation">,</span> </span>
<span class="">    based on the unsafe categories outlined below<span class="token punctuation">.</span></span>
<!-- -->    <!-- -->
<span class="">    Message<span class="token punctuation">:</span></span>
<span class="">    <span class="token operator">&lt;</span>message<span class="token operator">&gt;</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>message<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">    Unsafe Categories<span class="token punctuation">:</span></span>
<span class="">    <span class="token operator">&lt;</span>categories<span class="token operator">&gt;</span></span>
<span class="">    <span class="token punctuation">{</span>unsafe_category_str<span class="token punctuation">}</span></span>
<span class="">    <span class="token operator">&lt;</span><span class="token operator">/</span>categories<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">    Respond <span class="token keyword">with</span> ONLY a JSON <span class="token builtin">object</span><span class="token punctuation">,</span> using the <span class="token builtin">format</span> below<span class="token punctuation">:</span></span>
<span class="">    <span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="">    <span class="token string">"violation"</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>Boolean field denoting whether the message should be moderated<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Comma<span class="token operator">-</span>separated <span class="token builtin">list</span> of violated categories<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">"explanation"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Optional<span class="token punctuation">.</span> Only include <span class="token keyword">if</span> there <span class="token keyword">is</span> a violation<span class="token punctuation">.</span><span class="token punctuation">]</span></span>
<span class="">    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token string">""</span>"</span>
<!-- -->
<span class="">    <span class="token comment"># Send the request to Claude for content moderation</span></span>
<span class="">    response <span class="token operator">=</span> client<span class="token punctuation">.</span>messages<span class="token punctuation">.</span>create<span class="token punctuation">(</span></span>
<span class="">        model<span class="token operator">=</span><span class="token string">"claude-3-haiku-20240307"</span><span class="token punctuation">,</span>  <span class="token comment"># Using the Haiku model for lower costs</span></span>
<span class="">        max_tokens<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span></span>
<span class="">        temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment"># Use 0 temperature for increased consistency</span></span>
<span class="">        messages<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="">            <span class="token punctuation">{</span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> assessment_prompt<span class="token punctuation">}</span></span>
<span class="">        <span class="token punctuation">]</span></span>
<span class="">    <span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Parse the JSON response from Claude</span></span>
<span class="">    assessment <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Extract the violation status from the assessment</span></span>
<span class="">    contains_violation <span class="token operator">=</span> assessment<span class="token punctuation">[</span><span class="token string">'violation'</span><span class="token punctuation">]</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># If there's a violation, get the categories and explanation; otherwise, use empty defaults</span></span>
<span class="">    violated_categories <span class="token operator">=</span> assessment<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> contains_violation <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="">    explanation <span class="token operator">=</span> assessment<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'explanation'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> contains_violation <span class="token keyword">else</span> <span class="token boolean">None</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token keyword">return</span> contains_violation<span class="token punctuation">,</span> violated_categories<span class="token punctuation">,</span> explanation</span>
<!-- -->
<span class=""><span class="token comment"># Process each comment and print the results</span></span>
<span class=""><span class="token keyword">for</span> comment <span class="token keyword">in</span> user_comments<span class="token punctuation">:</span></span>
<span class="">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nComment: </span><span class="token interpolation"><span class="token punctuation">{</span>comment<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    violation<span class="token punctuation">,</span> violated_categories<span class="token punctuation">,</span> explanation <span class="token operator">=</span> moderate_message<span class="token punctuation">(</span>comment<span class="token punctuation">,</span> unsafe_categories<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token keyword">if</span> violation<span class="token punctuation">:</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Violated Categories: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">', '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>violated_categories<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Explanation: </span><span class="token interpolation"><span class="token punctuation">{</span>explanation<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No issues detected."</span><span class="token punctuation">)</span></span>
</code></pre></div></div></div>
<p>In this example, the <code>moderate_message</code> function contains an assessment prompt that includes the unsafe content categories and the message we wish to evaluate. The prompt asks Claude to assess whether the message should be moderated, based on the unsafe categories we defined.</p>
<p>The model’s assessment is then parsed to determine if there is a violation. If there is a violation, Claude also returns a list of violated categories, as well as an explanation as to why the message is unsafe.</p>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="evaluate-your-prompt"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#evaluate-your-prompt">​</a></div><span class="cursor-pointer">Evaluate your prompt</span></h3>
<p>Content moderation is a classification problem. Thus, you can use the same techniques outlined in our <a class="link" href="https://github.com/anthropics/anthropic-cookbook/blob/main/skills/classification/guide.ipynb" rel="noreferrer" target="_blank">classification cookbook</a> to determine the accuracy of your content moderation system.</p>
<p>One additional consideration is that instead of treating content moderation as a binary classification problem, you may instead create multiple categories to represent various risk levels. Creating multiple risk levels allows you to adjust the aggressiveness of your moderation. For example, you might want to automatically block user queries that are deemed high risk, while users with many medium risk queries are flagged for human review.</p>
<div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-50 bg-[#0F1117] dark:bg-codeblock ring-1 ring-transparent dark:ring-gray-800/50 codeblock-dark"><div class="min-w-full relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out" data-component-part="code-block-root" style="font-variant-ligatures:none;height:auto"><div class="overflow-x-auto h-full p-5 [&amp;&gt;pre&gt;code]:pr-[3rem] [&amp;&gt;pre&gt;code&gt;span.line-highlight]:min-w-[calc(100%+3rem)] overflow-y-hidden scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-white/20 dark:scrollbar-thumb-white/20 hover:scrollbar-thumb-white/25 dark:hover:scrollbar-thumb-white/25 active:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25"><pre class="language-python language-python"><code class="language-python"><span class=""><span class="token keyword">import</span> anthropic</span>
<span class=""><span class="token keyword">import</span> json</span>
<!-- -->
<span class=""><span class="token comment"># Initialize the Anthropic client</span></span>
<span class="">client <span class="token operator">=</span> anthropic<span class="token punctuation">.</span>Anthropic<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<!-- -->
<span class=""><span class="token keyword">def</span> <span class="token function">assess_risk_level</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> unsafe_categories<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="">    <span class="token comment"># Convert the list of unsafe categories into a string, with each category on a new line</span></span>
<span class="">    unsafe_category_str <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>unsafe_categories<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Construct the prompt for Claude, including the message, unsafe categories, and risk level definitions</span></span>
<span class="">    assessment_prompt <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f""</span></span>"</span>
<span class="">    Assess the risk level of the following message warrants moderation<span class="token punctuation">,</span> </span>
<span class="">    based on the unsafe categories listed below<span class="token punctuation">.</span></span>
<!-- -->    <!-- -->
<span class="">Message<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">&lt;</span>message<span class="token operator">&gt;</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>message<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">Unsafe Categories<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">&lt;</span>categories<span class="token operator">&gt;</span></span>
<span class=""><span class="token punctuation">{</span>unsafe_category_str<span class="token punctuation">}</span></span>
<span class=""><span class="token operator">&lt;</span><span class="token operator">/</span>categories<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">Assign a risk level based on your confidence that the user's message should be moderated </span>
<span class="">based on the defined unsafe categories<span class="token punctuation">:</span></span>
<!-- -->
<span class=""><span class="token number">0</span> <span class="token operator">-</span> No risk</span>
<span class=""><span class="token number">1</span> <span class="token operator">-</span> Low risk</span>
<span class=""><span class="token number">2</span> <span class="token operator">-</span> Medium risk</span>
<span class=""><span class="token number">3</span> <span class="token operator">-</span> High risk</span>
<!-- -->
<span class="">Respond <span class="token keyword">with</span> ONLY a JSON <span class="token builtin">object</span><span class="token punctuation">,</span> using the <span class="token builtin">format</span> below<span class="token punctuation">:</span></span>
<span class=""><span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="">  <span class="token string">"risk_level"</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>Numerical field denoting the risk level<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="">  <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Comma<span class="token operator">-</span>separated <span class="token builtin">list</span> of violated categories<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="">  <span class="token string">"explanation"</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>Optional<span class="token punctuation">.</span> Only include <span class="token keyword">if</span> risk level <span class="token keyword">is</span> greater than <span class="token number">0</span><span class="token operator">&gt;</span></span>
<span class=""><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token string">""</span>"</span>
<!-- -->
<span class="">    <span class="token comment"># Send the request to Claude for risk assessment</span></span>
<span class="">    response <span class="token operator">=</span> client<span class="token punctuation">.</span>messages<span class="token punctuation">.</span>create<span class="token punctuation">(</span></span>
<span class="">        model<span class="token operator">=</span><span class="token string">"claude-3-haiku-20240307"</span><span class="token punctuation">,</span>  <span class="token comment"># Using the Haiku model for lower costs</span></span>
<span class="">        max_tokens<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span></span>
<span class="">        temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment"># Use 0 temperature for increased consistency</span></span>
<span class="">        messages<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="">            <span class="token punctuation">{</span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> assessment_prompt<span class="token punctuation">}</span></span>
<span class="">        <span class="token punctuation">]</span></span>
<span class="">    <span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Parse the JSON response from Claude</span></span>
<span class="">    assessment <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Extract the risk level, violated categories, and explanation from the assessment</span></span>
<span class="">    risk_level <span class="token operator">=</span> assessment<span class="token punctuation">[</span><span class="token string">"risk_level"</span><span class="token punctuation">]</span></span>
<span class="">    violated_categories <span class="token operator">=</span> assessment<span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span></span>
<span class="">    explanation <span class="token operator">=</span> assessment<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"explanation"</span><span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token keyword">return</span> risk_level<span class="token punctuation">,</span> violated_categories<span class="token punctuation">,</span> explanation</span>
<!-- -->
<span class=""><span class="token comment"># Process each comment and print the results</span></span>
<span class=""><span class="token keyword">for</span> comment <span class="token keyword">in</span> user_comments<span class="token punctuation">:</span></span>
<span class="">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nComment: </span><span class="token interpolation"><span class="token punctuation">{</span>comment<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    risk_level<span class="token punctuation">,</span> violated_categories<span class="token punctuation">,</span> explanation <span class="token operator">=</span> assess_risk_level<span class="token punctuation">(</span>comment<span class="token punctuation">,</span> unsafe_categories<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Risk Level: </span><span class="token interpolation"><span class="token punctuation">{</span>risk_level<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    <span class="token keyword">if</span> violated_categories<span class="token punctuation">:</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Violated Categories: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">', '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>violated_categories<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    <span class="token keyword">if</span> explanation<span class="token punctuation">:</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Explanation: </span><span class="token interpolation"><span class="token punctuation">{</span>explanation<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
</code></pre></div></div></div>
<p>This code implements an <code>assess_risk_level</code> function that uses Claude to evaluate the risk level of a message. The function accepts a message and a list of unsafe categories as inputs.</p>
<p>Within the function, a prompt is generated for Claude, including the message to be assessed, the unsafe categories, and specific instructions for evaluating the risk level. The prompt instructs Claude to respond with a JSON object that includes the risk level, the violated categories, and an optional explanation.</p>
<p>This approach enables flexible content moderation by assigning risk levels. It can be seamlessly integrated into a larger system to automate content filtering or flag comments for human review based on their assessed risk level. For instance, when executing this code, the comment <code>Delete this post now or you better hide. I am coming after you and your family.</code> is identified as high risk due to its dangerous threat. Conversely, the comment <code>Stay away from the 5G cellphones!! They are using 5G to control you.</code> is categorized as medium risk.</p>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="deploy-your-prompt"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#deploy-your-prompt">​</a></div><span class="cursor-pointer">Deploy your prompt</span></h3>
<p>Once you are confident in the quality of your solution, it’s time to deploy it to production. Here are some best practices to follow when using content moderation in production:</p>
<ol>
<li>
<p><strong>Provide clear feedback to users:</strong> When user input is blocked or a response is flagged due to content moderation, provide informative and constructive feedback to help users understand why their message was flagged and how they can rephrase it appropriately. In the coding examples above, this is done through the <code>explanation</code> tag in the Claude response.</p>
</li>
<li>
<p><strong>Analyze moderated content:</strong> Keep track of the types of content being flagged by your moderation system to identify trends and potential areas for improvement.</p>
</li>
<li>
<p><strong>Continuously evaluate and improve:</strong> Regularly assess the performance of your content moderation system using metrics such as precision and recall tracking. Use this data to iteratively refine your moderation prompts, keywords, and assessment criteria.</p>
</li>
</ol>

<h2 class="flex whitespace-pre-wrap group font-semibold" id="improve-performance"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#improve-performance">​</a></div><span class="cursor-pointer">Improve performance</span></h2>
<p>In complex scenarios, it may be helpful to consider additional strategies to improve performance beyond standard <a class="link" href="https://docs.anthropic.com/en/docs/build-with-claude/prompt-engineering/overview" rel="noreferrer" target="_blank">prompt engineering techniques</a>. Here are some advanced strategies:</p>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="define-topics-and-provide-examples"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#define-topics-and-provide-examples">​</a></div><span class="cursor-pointer">Define topics and provide examples</span></h3>
<p>In addition to listing the unsafe categories in the prompt, further improvements can be made by providing definitions and phrases related to each category.</p>
<div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-50 bg-[#0F1117] dark:bg-codeblock ring-1 ring-transparent dark:ring-gray-800/50 codeblock-dark"><div class="min-w-full relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out" data-component-part="code-block-root" style="font-variant-ligatures:none;height:auto"><div class="overflow-x-auto h-full p-5 [&amp;&gt;pre&gt;code]:pr-[3rem] [&amp;&gt;pre&gt;code&gt;span.line-highlight]:min-w-[calc(100%+3rem)] overflow-y-hidden scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-white/20 dark:scrollbar-thumb-white/20 hover:scrollbar-thumb-white/25 dark:hover:scrollbar-thumb-white/25 active:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25"><pre class="language-python language-python"><code class="language-python"><span class=""><span class="token keyword">import</span> anthropic</span>
<span class=""><span class="token keyword">import</span> json</span>
<!-- -->
<span class=""><span class="token comment"># Initialize the Anthropic client</span></span>
<span class="">client <span class="token operator">=</span> anthropic<span class="token punctuation">.</span>Anthropic<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<!-- -->
<span class=""><span class="token comment"># Dictionary of categories considered unsafe for content moderation, with their definitions</span></span>
<span class="">unsafe_category_definitions <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="">    <span class="token string">'Child Exploitation'</span><span class="token punctuation">:</span> <span class="token string">'Content that depicts child nudity or that enables, encourages, excuses, or depicts the sexual abuse of children.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Conspiracy Theories'</span><span class="token punctuation">:</span> <span class="token string">""</span>"Content that promotes <span class="token keyword">or</span> endorses unfounded<span class="token punctuation">,</span> false<span class="token punctuation">,</span> <span class="token keyword">or</span> misleading theories about events<span class="token punctuation">,</span> situations<span class="token punctuation">,</span> <span class="token keyword">or</span> individuals<span class="token punctuation">,</span> </span>
<span class="">        which can incite harm <span class="token keyword">or</span> undermine public trust <span class="token keyword">in</span> institutions <span class="token keyword">or</span> facts<span class="token punctuation">.</span><span class="token string">""</span>"<span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Hate'</span><span class="token punctuation">:</span> <span class="token string">""</span>"Content that <span class="token keyword">is</span> hateful toward people on the basis of their protected characteristics </span>
<span class="">        <span class="token punctuation">(</span>race<span class="token punctuation">,</span> color<span class="token punctuation">,</span> ethnicity<span class="token punctuation">,</span> national origin<span class="token punctuation">,</span> disability<span class="token punctuation">,</span> religious affiliation<span class="token punctuation">,</span> caste<span class="token punctuation">,</span> sexual orientation<span class="token punctuation">,</span> sex<span class="token punctuation">,</span> gender identity <span class="token keyword">and</span> serious disease<span class="token punctuation">)</span><span class="token punctuation">,</span> </span>
<span class="">        <span class="token keyword">or</span> content that perpetuates negative stereotypes<span class="token punctuation">.</span><span class="token string">""</span>"<span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Indiscriminate Weapons'</span><span class="token punctuation">:</span> <span class="token string">'Content that enables the creation of weapons of mass destruction.'</span><span class="token punctuation">,</span> </span>
<span class="">    <span class="token string">'Intellectual Property'</span><span class="token punctuation">:</span> <span class="token string">'Content that violates the intellectual property rights of third parties.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Non-Violent Crimes'</span><span class="token punctuation">:</span> <span class="token string">'Content that enables, encourages, or excuses the commission of non-violent crimes.'</span><span class="token punctuation">,</span> </span>
<span class="">    <span class="token string">'Privacy'</span><span class="token punctuation">:</span> <span class="token string">'Content that contains sensitive, personal information about private individuals.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Self-Harm'</span><span class="token punctuation">:</span> <span class="token string">'Content that enables, encourages, or excuses acts of intentional self-harm.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Sex Crimes'</span><span class="token punctuation">:</span> <span class="token string">'Content that enables, encourages, or excuses the commission of sex crimes.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Sexual Content'</span><span class="token punctuation">:</span> <span class="token string">'Content that contains erotic descriptions or explicit depictions of sex acts.'</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Specialized Advice'</span><span class="token punctuation">:</span> <span class="token string">""</span>"Content that contains financial<span class="token punctuation">,</span> medical<span class="token punctuation">,</span> <span class="token keyword">or</span> legal advice<span class="token punctuation">.</span> </span>
<span class="">        Financial advice includes guidance on investments<span class="token punctuation">,</span> stocks<span class="token punctuation">,</span> bonds<span class="token punctuation">,</span> <span class="token keyword">or</span> <span class="token builtin">any</span> financial planning<span class="token punctuation">.</span><span class="token string">""</span>"<span class="token punctuation">,</span></span>
<span class="">    <span class="token string">'Violent Crimes'</span><span class="token punctuation">:</span> <span class="token string">'Content that enables, encourages, or excuses the commission of violent crimes.'</span><span class="token punctuation">,</span> </span>
<span class=""><span class="token punctuation">}</span></span>
<!-- -->
<!-- -->
<span class=""><span class="token keyword">def</span> <span class="token function">moderate_message_with_definitions</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> unsafe_category_definitions<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="">    <span class="token comment"># Format unsafe categories string, with each category and its definition on a new line</span></span>
<span class="">    unsafe_category_str <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>category<span class="token punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token punctuation">{</span>definition<span class="token punctuation">}</span></span><span class="token string">'</span></span> </span>
<span class="">        <span class="token keyword">for</span> category<span class="token punctuation">,</span> definition <span class="token keyword">in</span> unsafe_category_definitions<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="">    <span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Construct the prompt for Claude, including the message and unsafe categories</span></span>
<span class="">    assessment_prompt <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f""</span></span>"Determine whether the following message warrants moderation<span class="token punctuation">,</span> based on the unsafe categories outlined below<span class="token punctuation">.</span></span>
<!-- -->
<span class="">Message<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">&lt;</span>message<span class="token operator">&gt;</span><span class="token punctuation">{</span>message<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>message<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">Unsafe Categories <span class="token keyword">and</span> Their Definitions<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">&lt;</span>categories<span class="token operator">&gt;</span></span>
<span class=""><span class="token punctuation">{</span>unsafe_category_str<span class="token punctuation">}</span></span>
<span class=""><span class="token operator">&lt;</span><span class="token operator">/</span>categories<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">It's important that you remember <span class="token builtin">all</span> unsafe categories <span class="token keyword">and</span> their definitions<span class="token punctuation">.</span></span>
<!-- -->
<span class="">Respond <span class="token keyword">with</span> ONLY a JSON <span class="token builtin">object</span><span class="token punctuation">,</span> using the <span class="token builtin">format</span> below<span class="token punctuation">:</span></span>
<span class=""><span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="">  <span class="token string">"violation"</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>Boolean field denoting whether the message should be moderated<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="">  <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Comma<span class="token operator">-</span>separated <span class="token builtin">list</span> of violated categories<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="">  <span class="token string">"explanation"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Optional<span class="token punctuation">.</span> Only include <span class="token keyword">if</span> there <span class="token keyword">is</span> a violation<span class="token punctuation">.</span><span class="token punctuation">]</span></span>
<span class=""><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token string">""</span>"</span>
<!-- -->
<span class="">    <span class="token comment"># Send the request to Claude for content moderation</span></span>
<span class="">    response <span class="token operator">=</span> client<span class="token punctuation">.</span>messages<span class="token punctuation">.</span>create<span class="token punctuation">(</span></span>
<span class="">        model<span class="token operator">=</span><span class="token string">"claude-3-haiku-20240307"</span><span class="token punctuation">,</span>  <span class="token comment"># Using the Haiku model for lower costs</span></span>
<span class="">        max_tokens<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span></span>
<span class="">        temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>   <span class="token comment"># Use 0 temperature for increased consistency</span></span>
<span class="">        messages<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="">            <span class="token punctuation">{</span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> assessment_prompt<span class="token punctuation">}</span></span>
<span class="">        <span class="token punctuation">]</span></span>
<span class="">    <span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Parse the JSON response from Claude</span></span>
<span class="">    assessment <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Extract the violation status from the assessment</span></span>
<span class="">    contains_violation <span class="token operator">=</span> assessment<span class="token punctuation">[</span><span class="token string">'violation'</span><span class="token punctuation">]</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># If there's a violation, get the categories and explanation; otherwise, use empty defaults</span></span>
<span class="">    violated_categories <span class="token operator">=</span> assessment<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">if</span> contains_violation <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="">    explanation <span class="token operator">=</span> assessment<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'explanation'</span><span class="token punctuation">)</span> <span class="token keyword">if</span> contains_violation <span class="token keyword">else</span> <span class="token boolean">None</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token keyword">return</span> contains_violation<span class="token punctuation">,</span> violated_categories<span class="token punctuation">,</span> explanation</span>
<!-- -->
<!-- -->
<span class=""><span class="token comment"># Process each comment and print the results</span></span>
<span class=""><span class="token keyword">for</span> comment <span class="token keyword">in</span> user_comments<span class="token punctuation">:</span></span>
<span class="">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"\nComment: </span><span class="token interpolation"><span class="token punctuation">{</span>comment<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    violation<span class="token punctuation">,</span> violated_categories<span class="token punctuation">,</span> explanation <span class="token operator">=</span> moderate_message_with_definitions<span class="token punctuation">(</span>comment<span class="token punctuation">,</span> unsafe_category_definitions<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token keyword">if</span> violation<span class="token punctuation">:</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Violated Categories: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">', '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>violated_categories<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Explanation: </span><span class="token interpolation"><span class="token punctuation">{</span>explanation<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></span>
<span class="">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>
<span class="">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No issues detected."</span><span class="token punctuation">)</span></span>
</code></pre></div></div></div>
<p>The <code>moderate_message_with_definitions</code> function expands upon the earlier <code>moderate_message</code> function by allowing each unsafe category to be paired with a detailed definition. This occurs in the code by replacing the <code>unsafe_categories</code> list from the original function with an <code>unsafe_category_definitions</code> dictionary. This dictionary maps each unsafe category to its corresponding definition. Both the category names and their definitions are included in the prompt.</p>
<p>Notably, the definition for the <code>Specialized Advice</code> category now specifies the types of financial advice that should be prohibited. As a result, the comment <code>It's a great time to invest in gold!</code>, which previously passed the <code>moderate_message</code> assessment, now triggers a violation.</p>
<h3 class="flex whitespace-pre-wrap group font-semibold" id="consider-batch-processing"><div class="absolute"><a aria-label="Navigate to header" class="-ml-10 flex items-center opacity-0 border-0 group-hover:opacity-100" href="#consider-batch-processing">​</a></div><span class="cursor-pointer">Consider batch processing</span></h3>
<p>To reduce costs in situations where real-time moderation isn’t necessary, consider moderating messages in batches. Include multiple messages within the prompt’s context, and ask Claude to assess which messages should be moderated.</p>
<div class="code-block mt-5 mb-8 not-prose rounded-2xl relative group text-gray-50 bg-[#0F1117] dark:bg-codeblock ring-1 ring-transparent dark:ring-gray-800/50 codeblock-dark"><div class="min-w-full relative text-sm leading-6 children:!my-0 children:!shadow-none children:!bg-transparent transition-[height] duration-300 ease-in-out" data-component-part="code-block-root" style="font-variant-ligatures:none;height:auto"><div class="overflow-x-auto h-full p-5 [&amp;&gt;pre&gt;code]:pr-[3rem] [&amp;&gt;pre&gt;code&gt;span.line-highlight]:min-w-[calc(100%+3rem)] overflow-y-hidden scrollbar-thin scrollbar-thumb-rounded scrollbar-thumb-white/20 dark:scrollbar-thumb-white/20 hover:scrollbar-thumb-white/25 dark:hover:scrollbar-thumb-white/25 active:scrollbar-thumb-white/25 dark:active:scrollbar-thumb-white/25"><pre class="language-python language-python"><code class="language-python"><span class=""><span class="token keyword">import</span> anthropic</span>
<span class=""><span class="token keyword">import</span> json</span>
<!-- -->
<span class=""><span class="token comment"># Initialize the Anthropic client</span></span>
<span class="">client <span class="token operator">=</span> anthropic<span class="token punctuation">.</span>Anthropic<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<!-- -->
<span class=""><span class="token keyword">def</span> <span class="token function">batch_moderate_messages</span><span class="token punctuation">(</span>messages<span class="token punctuation">,</span> unsafe_categories<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="">    <span class="token comment"># Convert the list of unsafe categories into a string, with each category on a new line</span></span>
<span class="">    unsafe_category_str <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>unsafe_categories<span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Format messages string, with each message wrapped in XML-like tags and given an ID</span></span>
<span class="">    messages_str <span class="token operator">=</span> <span class="token string">'\n'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f'&lt;message id=</span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>msg<span class="token punctuation">}</span></span><span class="token string">&lt;/message&gt;'</span></span> <span class="token keyword">for</span> idx<span class="token punctuation">,</span> msg <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Construct the prompt for Claude, including the messages and unsafe categories</span></span>
<span class="">    assessment_prompt <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f""</span></span>"Determine the messages to moderate<span class="token punctuation">,</span> based on the unsafe categories outlined below<span class="token punctuation">.</span></span>
<!-- -->
<span class="">Messages<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">&lt;</span>messages<span class="token operator">&gt;</span></span>
<span class=""><span class="token punctuation">{</span>messages_str<span class="token punctuation">}</span></span>
<span class=""><span class="token operator">&lt;</span><span class="token operator">/</span>messages<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">Unsafe categories <span class="token keyword">and</span> their definitions<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">&lt;</span>categories<span class="token operator">&gt;</span></span>
<span class=""><span class="token punctuation">{</span>unsafe_category_str<span class="token punctuation">}</span></span>
<span class=""><span class="token operator">&lt;</span><span class="token operator">/</span>categories<span class="token operator">&gt;</span></span>
<!-- -->
<span class="">Respond <span class="token keyword">with</span> ONLY a JSON <span class="token builtin">object</span><span class="token punctuation">,</span> using the <span class="token builtin">format</span> below<span class="token punctuation">:</span></span>
<span class=""><span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="">  <span class="token string">"violations"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></span>
<span class="">    <span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="">      <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>message <span class="token builtin">id</span><span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="">      <span class="token string">"categories"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token builtin">list</span> of violated categories<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="">      <span class="token string">"explanation"</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>Explanation of why there's a violation<span class="token operator">&gt;</span></span>
<span class="">    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="">  <span class="token punctuation">]</span></span>
<span class=""><span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<!-- -->
<span class="">Important Notes<span class="token punctuation">:</span></span>
<span class=""><span class="token operator">-</span> Remember to analyze every message <span class="token keyword">for</span> a violation<span class="token punctuation">.</span></span>
<span class=""><span class="token operator">-</span> Select <span class="token builtin">any</span> number of violations that reasonably <span class="token builtin">apply</span><span class="token punctuation">.</span><span class="token string">""</span>"</span>
<!-- -->
<span class="">    <span class="token comment"># Send the request to Claude for content moderation</span></span>
<span class="">    response <span class="token operator">=</span> client<span class="token punctuation">.</span>messages<span class="token punctuation">.</span>create<span class="token punctuation">(</span></span>
<span class="">        model<span class="token operator">=</span><span class="token string">"claude-3-haiku-20240307"</span><span class="token punctuation">,</span>  <span class="token comment"># Using the Haiku model for lower costs</span></span>
<span class="">        max_tokens<span class="token operator">=</span><span class="token number">2048</span><span class="token punctuation">,</span>  <span class="token comment"># Increased max token count to handle batches</span></span>
<span class="">        temperature<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment"># Use 0 temperature for increased consistency</span></span>
<span class="">        messages<span class="token operator">=</span><span class="token punctuation">[</span></span>
<span class="">            <span class="token punctuation">{</span><span class="token string">"role"</span><span class="token punctuation">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> assessment_prompt<span class="token punctuation">}</span></span>
<span class="">        <span class="token punctuation">]</span></span>
<span class="">    <span class="token punctuation">)</span></span>
<!-- -->    <!-- -->
<span class="">    <span class="token comment"># Parse the JSON response from Claude</span></span>
<span class="">    assessment <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response<span class="token punctuation">.</span>content<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>
<span class="">    <span class="token keyword">return</span> assessment</span>
<!-- -->
<!-- -->
<span class=""><span class="token comment"># Process the batch of comments and get the response</span></span>
<span class="">response_obj <span class="token operator">=</span> batch_moderate_messages<span class="token punctuation">(</span>user_comments<span class="token punctuation">,</span> unsafe_categories<span class="token punctuation">)</span></span>
<!-- -->
<span class=""><span class="token comment"># Print the results for each detected violation</span></span>
<span class=""><span class="token keyword">for</span> violation <span class="token keyword">in</span> response_obj<span class="token punctuation">[</span><span class="token string">'violations'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>
<span class="">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f""</span></span>"Comment<span class="token punctuation">:</span> <span class="token punctuation">{</span>user_comments<span class="token punctuation">[</span>violation<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
<span class="">Violated Categories<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">', '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>violation<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="">Explanation<span class="token punctuation">:</span> <span class="token punctuation">{</span>violation<span class="token punctuation">[</span><span class="token string">'explanation'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
<span class=""><span class="token string">""</span>"<span class="token punctuation">)</span></span>
</code></pre></div></div></div>
<p>In this example, the <code>batch_moderate_messages</code> function handles the moderation of an entire batch of messages with a single Claude API call.
Inside the function, a prompt is created that includes the list of messages to evaluate, the defined unsafe content categories, and their descriptions. The prompt directs Claude to return a JSON object listing all messages that contain violations. Each message in the response is identified by its id, which corresponds to the message’s position in the input list.
Keep in mind that finding the optimal batch size for your specific needs may require some experimentation. While larger batch sizes can lower costs, they might also lead to a slight decrease in quality. Additionally, you may need to increase the <code>max_tokens</code> parameter in the Claude API call to accommodate longer responses. For details on the maximum number of tokens your chosen model can output, refer to the <a class="link" href="https://docs.anthropic.com/en/docs/about-claude/models#model-comparison" rel="noreferrer" target="_blank">model comparison page</a>.</p>
<div class="card-group not-prose grid gap-x-4 sm:grid-cols-2"><a class="card block font-normal group relative my-2 ring-2 ring-transparent rounded-2xl bg-white dark:bg-background-dark border border-gray-950/10 dark:border-white/10 overflow-hidden w-full cursor-pointer hover:!border-primary dark:hover:!border-primary-light" href="https://github.com/anthropics/anthropic-cookbook/blob/main/misc/building%5Fmoderation%5Ffilter.ipynb" rel="noreferrer" target="_blank"><div class="px-6 py-5 relative" data-component-part="card-content-container"><div><h2 class="not-prose font-semibold text-base text-gray-800 dark:text-white mt-4" contenteditable="false" data-component-part="card-title">Content moderation cookbook</h2><div class="prose mt-1 font-normal text-sm leading-6 text-gray-600 dark:text-gray-400" data-component-part="card-content"><p>View a fully implemented code-based example of how to use Claude for content moderation.</p></div></div></div></a><a class="card block font-normal group relative my-2 ring-2 ring-transparent rounded-2xl bg-white dark:bg-background-dark border border-gray-950/10 dark:border-white/10 overflow-hidden w-full cursor-pointer hover:!border-primary dark:hover:!border-primary-light" href="https://docs.anthropic.com/en/docs/test-and-evaluate/strengthen-guardrails/reduce-hallucinations" rel="noreferrer" target="_blank"><div class="px-6 py-5 relative" data-component-part="card-content-container"><div><h2 class="not-prose font-semibold text-base text-gray-800 dark:text-white mt-4" contenteditable="false" data-component-part="card-title">Guardrails guide</h2><div class="prose mt-1 font-normal text-sm leading-6 text-gray-600 dark:text-gray-400" data-component-part="card-content"><p>Explore our guardrails guide for techniques to moderate interactions with Claude.</p></div></div></div></a></div></div><div class="leading-6 mt-14"><div class="feedback-toolbar pb-16 w-full"><div class="flex flex-col gap-y-4 xl:flex-col xl:gap-6 min-[1400px]:flex-row md:flex-row md:justify-end"><div class="flex flex-row gap-5 items-center grow justify-between md:justify-start xl:justify-between min-[1400px]:justify-start"><p class="text-sm text-gray-600 dark:text-gray-400">Was this page helpful?</p><div class="flex flex-row gap-3 items-center"><button class="px-3.5 py-2 flex flex-row gap-3 items-center border-standard rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 bg-white/50 dark:bg-codeblock/50 hover:border-gray-500 hover:dark:border-gray-500"><small class="text-sm font-normal leading-4">Yes</small></button><button class="px-3.5 py-2 flex flex-row gap-3 items-center border-standard rounded-xl text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 bg-white/50 dark:bg-codeblock/50 hover:border-gray-500 hover:dark:border-gray-500"><small class="text-sm font-normal leading-4">No</small></button></div></div></div></div><div class="mb-12 px-0.5 flex items-center text-sm font-semibold text-gray-700 dark:text-gray-200" id="pagination"><a class="flex items-center space-x-3 group" href="/en/docs/about-claude/use-case-guides/customer-support-chat"><span class="group-hover:text-gray-900 dark:group-hover:text-white">Customer support agent</span></a><a class="flex items-center ml-auto space-x-3 group" href="/en/docs/about-claude/use-case-guides/legal-summarization"><span class="group-hover:text-gray-900 dark:group-hover:text-white">Legal summarization</span></a></div></div></div><div class="hidden xl:flex self-start sticky xl:flex-col h-[calc(100vh-9.5rem)] top-[9.5rem]" id="content-side-layout"><div class="z-10 hidden xl:flex pl-10 box-border w-[19rem] max-h-full" id="table-of-contents-layout"><div class="text-gray-600 text-sm leading-6 w-[16.5rem] overflow-y-auto space-y-2 pb-4 -mt-10 pt-10" id="table-of-contents"><div class="text-gray-700 dark:text-gray-300 font-medium flex items-center space-x-2"><span>On this page</span></div></div></div></div></div></div></div></div></main>